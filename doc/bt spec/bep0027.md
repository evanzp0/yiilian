# Private Torrents

<a id="id1" ></a>
本文中的关键词 "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", 和 "OPTIONAL" 
应按照 IETF RFC 2119 [\[6\]](#rfc-2119) 中的描述进行解释。

`private tracker`（私有追踪器）限制对其所追踪的 torrent 文件的访问。
具有访问限制的 torrent 文件称为 `private torrent`。所有其他 torrent 文件均为 `public torrents`。
为了促进共享，`private tracker` 通常会维护注册用户的统计数据，并对未能充分上传的用户限制访问某些或所有 torrent 文件。

<a id="id2" ></a>
在生成 `metainfo` 文件时，用户可以通过在 torrent 文件的 "info" 字典中包含键值对 "private=1" 来将 torrent 标记为私有 [\[1\]](#bep-3)。

当 BitTorrent 客户端获取到包含 "private=1" 键值对的 `metainfo` 文件时，必须仅向 `private tracker` 宣告自身，并且必须仅与从 `private tracker` 返回的对等节点（peers）建立连接。

 <a id="id3" ></a>
当 `private torrent` 的 `metainfo` 文件中的 `announce-list` 中出现多个 `tracker` 时（参见 [\[4\]](#bep-12)中的多追踪器扩展），
每个对等节点必须一次仅使用一个 `tracker`，并且仅在当前 `tracker` 失效时切换到其他 `tracker`。
在切换 `tracker` 时，对等节点必须断开与所有当前对等节点的连接，并仅连接到新 `tracker` 提供的对等节点。

## Rationale（原理）

`private tracker` 通过拒绝返回对等节点列表（peer list）来阻止外部节点加入 `private torrent`。
一旦入侵者节点获取了对等节点的 IP 地址和端口（无论来源如何），入侵者便可以与该对等节点建立连接并交换 pieces（数据片段）。
一旦进入 swarm（群组），入侵者将获得与所有其他对等节点相同的待遇。

目前，BitTorrent 中有四种方式可以让一个对等节点（peer）了解到 swarm 中的其他对等节点：

1. Trackers（追踪器）[\[1\]](#bep-3) <a id="id4" ></a>
2. Distributed Hash Table, DHT（分布式哈希表）[\[2\]](#bep-5) <a id="id5" ></a>
3. Peer Exchange, PEX（对等节点交换）[\[3\]](#bep-11) <a id="id6" ></a>
4. Local Service Discovery, LSD（本地服务发现）[\[5\]](#bep-14) <a id="id7" ></a>

通过除 `private tracker` 之外的任何机制（例如 DHT、PEX 或 LSD）宣告或交换对等节点信息，都会破坏 `tracker` 的访问控制。

尽管 PEX 仅向已经在群组中的其他对等节点提供对等节点信息，但如果入侵者获取或猜测到已经在 `private torrent` 中的某个对等节点的 IP 和端口，
那么与该入侵者交换对等节点信息将为其提供完整的对等节点列表。

当对等节点在 `tracker` 之间切换时，它会断开现有连接，以确保不会成为从 `private tracker` 获得访问权限的对等节点与向 `public tracker` 宣告的对等节点之间的桥梁。
这在一定程度上减轻了攻击者修改 metainfo 文件的 `announce-list` 后，通过 `public tracker` 网站重新分发元信息文件的影响。

## History（历史）

私有 torrent 最初在 Azureus 中引入。

## References（参考文献）  
[1] (<a id="bep-3" ></a>[1](#id2), <a id="bep-5" ></a>[2](#id4)) BEP_0003. BitTorrent 协议规范。Cohen. http://www.bittorrent.org/beps/bep_0003.html  
<a id="bep-5" ></a>[[2](#id5)] BEP_0005. DHT 协议。Loewenstern. http://www.bittorrent.org/beps/bep_0005.html  
<a id="bep-11" ></a>[[3](#id6)] BEP_0011. 对等节点交换（Peer EXchange，待定）  
<a id="bep-12" ></a>[[4](#id3)] BEP_0012. 多追踪器元数据扩展。Hoffman. http://www.bittorrent.org/beps/bep_0012.html  
<a id="bep-14" ></a>[[5](#id7)] BEP_0014. 本地服务发现（Local Service Discovery）。Harrison, Hazel. http://www.bittorrent.org/beps/bep_0014.html  
<a id="rfc-2119" ></a>[[6](#id1)] RFC-2119. http://www.ietf.org/rfc/rfc2119.txt  